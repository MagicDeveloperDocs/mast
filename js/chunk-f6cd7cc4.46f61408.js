(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f6cd7cc4"],{"04d1":function(t,e,n){var a=n("342f"),i=a.match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},1779:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"farms"},[n("notify",{ref:"notify"}),n("div",{staticClass:"main"},[n("div",{staticClass:"farms-banner center"},[n("div",{staticClass:"farms-banner-cont"},[n("h5",[t._v(t._s(t.$t("挖矿耕耘")))]),n("p",[t._v("Stake "+t._s(t.coin)+" tokens to earn")])])]),n("div",{staticClass:"farms-cont"},[n("div",{staticClass:"farms-current"},[n("a",{staticClass:"farms-back",on:{click:function(e){return t.$router.back()}}},[n("i",{staticClass:"ico ico-alone-left"}),t._v(t._s(t.$t("返回")))]),n("div",{staticClass:"farms-current-tab"},[n("a",{staticClass:"btn",class:["stake"===t.type?"active":""],on:{click:function(e){t.type="stake"}}},[t._v(t._s(t.$t("质押"))+" "),n("shadow")]),n("a",{staticClass:"btn",class:["withdraw"===t.type?"active":""],on:{click:function(e){t.type="withdraw"}}},[t._v(t._s(t.$t("活期提现"))+" "),n("shadow")])]),"stake"==t.type?n("div",{staticClass:"farms-main"},[n("div",{staticClass:"farms-balance"},[n("span",[t._v(t._s(t.$t("可质押余额")))]),n("b",[n("em",[t._v(t._s(t.balance))]),t._v(t._s(t.coin))])]),n("div",{staticClass:"farms-form"},["mgp"===t.coin?n("i",{staticClass:"ico-ico-mgp"}):t._e(),"mast"===t.coin?n("i",{staticClass:"ico-ico-mast"}):t._e(),n("input",{attrs:{type:"text"},domProps:{value:t.inputAmount},on:{input:t.amountInput}}),n("cite"),n("a",{staticClass:"btn btn-empty",on:{click:function(e){t.inputAmount=t.balance}}},[t._v(t._s(t.$t("最大")))])]),t.approve?t._e():n("a",{staticClass:"btn",on:{click:t.stake}},[t._v(t._s(t.$t("质押"))+" "),n("shadow")]),t.approve?n("a",{staticClass:"btn",on:{click:t.goApprove}},[t._v(t._s(t.$t("授权"))+" "),n("shadow")]):t._e()]):t._e(),"withdraw"==t.type?n("div",{staticClass:"farms-main"},[n("div",{staticClass:"farms-balance"},[n("span",[t._v(t._s(t.$t("活期可提额度")))]),n("b",[n("em",[t._v(t._s(t.withdrawAmount))]),t._v(t._s(t.xTokenName))])]),n("div",{staticClass:"farms-form"},["mgp"===t.coin?n("i",{staticClass:"ico-ico-mgp"}):t._e(),"mast"===t.coin?n("i",{staticClass:"ico-ico-mast"}):t._e(),n("input",{attrs:{type:"text"},domProps:{value:t.inputAmount},on:{input:t.amountInput}}),n("cite"),n("a",{staticClass:"btn btn-empty",on:{click:function(e){t.inputAmount=t.withdrawAmount}}},[t._v(t._s(t.$t("最大")))])]),n("a",{staticClass:"btn",on:{click:t.withdraw}},[t._v(t._s(t.$t("提现"))+" "),n("shadow")])]):t._e()])]),t.total>0?n("div",{staticClass:"farms-cont",staticStyle:{"margin-top":"20px"}},[n("div",{staticClass:"table farms-table"},[n("table",[n("thead",[n("tr",[n("td",[t._v(t._s(t.$t("可解锁时间窗口")))]),n("td",[t._v(t._s(t.$t("数量")))]),n("td",[t._v(t._s(t.$t("加权算力")))]),n("td",[t._v(t._s(t.$t("质押时间")))]),n("td",[t._v(t._s(t.$t("操作")))])])]),n("tbody",t._l(t.showRecord,(function(e,a){return n("tr",{key:a},[n("td",[t._v(t._s(t.unLockTime(e)))]),n("td",[t._v(t._s(t._f("toFixed")(t._f("toAmount")(e.amount),4)))]),n("td",[t._v(t._s(t._f("toFixed")(t._f("toAmount")(e.power),4)))]),n("td",[t._v(t._s(t._f("formatTimer")(1e3*e.startTime)))]),n("td",[1===t.status(e)?n("a",{staticClass:"btn",on:{click:function(n){return t.withdrawStake(e.id)}}},[t._v(t._s(t.$t("可解锁"))+" "),n("shadow")]):t._e(),2===t.status(e)?n("a",{staticClass:"btn"},[t._v(t._s(t.$t("等待解锁"))+" "),n("shadow")]):t._e(),3===t.status(e)?n("a",{staticClass:"btn"},[t._v(t._s(t.$t("已完成"))+" "),n("shadow")]):t._e()])])})),0)]),t.totalPage>t.limit?n("Pagination",{attrs:{"prev-text":t.$t("上一页"),"next-text":t.$t("下一页"),"items-per-page":t.limit,"total-items":t.totalPage,mode:"simple"},on:{change:t.showPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)]):t._e()])],1)},i=[],s=n("1da1"),r=n("ade3"),o=(n("3cd0"),n("dc09"),n("d282")),c="van-hairline",u=Object(o["a"])("pagination"),l=u[0],d=u[1],f=u[2];function m(t,e,n){return{number:t,text:e,active:n}}var p=l({props:{prevText:String,nextText:String,forceEllipses:Boolean,mode:{type:String,default:"multi"},value:{type:Number,default:0},pageCount:{type:[Number,String],default:0},totalItems:{type:[Number,String],default:0},itemsPerPage:{type:[Number,String],default:10},showPageSize:{type:[Number,String],default:5}},computed:{count:function(){var t=this.pageCount||Math.ceil(this.totalItems/this.itemsPerPage);return Math.max(1,t)},pages:function(){var t=[],e=this.count,n=+this.showPageSize;if("multi"!==this.mode)return t;var a=1,i=e,s=n<e;s&&(a=Math.max(this.value-Math.floor(n/2),1),i=a+n-1,i>e&&(i=e,a=i-n+1));for(var r=a;r<=i;r++){var o=m(r,r,r===this.value);t.push(o)}if(s&&n>0&&this.forceEllipses){if(a>1){var c=m(a-1,"...",!1);t.unshift(c)}if(i<e){var u=m(i+1,"...",!1);t.push(u)}}return t}},watch:{value:{handler:function(t){this.select(t||this.value)},immediate:!0}},methods:{select:function(t,e){t=Math.min(this.count,Math.max(1,t)),this.value!==t&&(this.$emit("input",t),e&&this.$emit("change",t))}},render:function(){var t,e,n=this,a=arguments[0],i=this.value,s="multi"!==this.mode,r=function(t){return function(){n.select(t,!0)}};return a("ul",{class:d({simple:s})},[a("li",{class:[d("item",{disabled:1===i}),d("prev"),c],on:{click:r(i-1)}},[(null!=(t=this.slots("prev-text"))?t:this.prevText)||f("prev")]),this.pages.map((function(t){var e;return a("li",{class:[d("item",{active:t.active}),d("page"),c],on:{click:r(t.number)}},[null!=(e=n.slots("page",t))?e:t.text])})),s&&a("li",{class:d("page-desc")},[this.slots("pageDesc")||i+"/"+this.count]),a("li",{class:[d("item",{disabled:i===this.count}),d("next"),c],on:{click:r(i+1)}},[(null!=(e=this.slots("next-text"))?e:this.nextText)||f("next")])])}}),h=(n("96cf"),n("b680"),n("fb6a"),n("99af"),n("4e82"),n("a630"),n("3ca3"),n("ee7a")),v=n("901e"),g=n.n(v),w={name:"current",computed:{},components:{Notify:h["a"],Pagination:p},watch:Object(r["a"])({},"$store.state.walletAddress",(function(){this.init()})),data:function(){return{timeId:null,now:"0",unlockTimeWindow:"0",inputAmount:"",coin:"mgp",pid:"0",balance:"0",withdrawAmount:"0",approve:!0,type:"stake",xTokenName:"",total:0,totalPage:0,currentPage:1,limit:2,showRecord:[],lockOrder:[]}},methods:{status:function(t){if(!0===t.over)return 3;var e=this.now,n=this.unlockTimeWindow,a=new g.a(e).minus(t.startTime).div(t.lockTime).toFixed(0,g.a.ROUND_DOWN),i=new g.a(t.startTime).plus(new g.a(a).multipliedBy(t.lockTime)).toFixed(0,g.a.ROUND_DOWN),s=new g.a(i).plus(n).toFixed(0,g.a.ROUND_DOWN);return new g.a(a).comparedTo(0)>0&&new g.a(e).comparedTo(i)>=0&&new g.a(e).comparedTo(s)<=0?1:2},showPage:function(){this.totalPage=this.lockOrder.length;var t=(this.currentPage-1)*this.limit;this.showRecord=this.lockOrder.slice(t,t+this.limit)},unLockTime:function(t){if(!0===t.over)return"-";var e=this.now,n=this.unlockTimeWindow,a=new g.a(e).minus(t.startTime).div(t.lockTime).toFixed(0,g.a.ROUND_DOWN);0===new g.a(a).comparedTo("0")&&(a=1);var i=new g.a(t.startTime).plus(new g.a(a).multipliedBy(t.lockTime)).toFixed(0,g.a.ROUND_DOWN),s=new g.a(i).plus(n).toFixed(0,g.a.ROUND_DOWN);return new g.a(e).comparedTo(s)<=0||(i=new g.a(i).plus(t.lockTime).toFixed(0,g.a.ROUND_DOWN),s=new g.a(i).plus(n).toFixed(0,g.a.ROUND_DOWN)),"".concat(this.$filters.formatTimer(1e3*i)," - ").concat(this.$filters.formatTimer(1e3*s))},withdraw:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$loading.show(),e.prev=1,t.$utils.isNumber(t.inputAmount)&&!(new g.a(t.inputAmount).comparedTo(t.withdrawAmount)>0)){e.next=4;break}throw new Error(t.$t("请输入正确的值"));case 4:return n=new g.a(t.inputAmount).multipliedBy(1e18).toFixed(0,g.a.ROUND_DOWN),e.next=7,t.$api.getConnect().stake(t.coin).withdraw(n);case 7:return a=e.sent,t.$refs.notify.show(a.getHash()),e.next=11,a.confirm();case 11:return t.$toast(t.$t("提现成功")),e.next=14,t.init();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](1),t.$toast(e.t0.message);case 19:return e.prev=19,t.$loading.hide(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})))()},withdrawStake:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$loading.show(),n.prev=1,n.next=4,e.$api.getConnect().stake(e.coin).withdrawStake([t]);case 4:return a=n.sent,e.$refs.notify.show(a.getHash()),n.next=8,a.confirm();case 8:return e.$toast(e.$t("解锁成功")),n.next=11,e.init();case 11:n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](1),e.$toast(n.t0.message);case 16:return n.prev=16,e.$loading.hide(),n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[1,13,16,19]])})))()},amountInput:function(t){var e=t.target.value;this.inputAmount=e},stake:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.$loading.show(),t.$utils.isNumber(t.inputAmount)&&!(new g.a(t.inputAmount).comparedTo(t.balance)>0)){e.next=4;break}throw new Error(t.$t("输入的值不正确"));case 4:return n=new g.a(t.inputAmount).multipliedBy(1e18).toFixed(0,g.a.ROUND_DOWN),e.next=7,t.$api.getConnect().stake(t.coin).stake(t.pid,n);case 7:return a=e.sent,e.next=10,a.confirm();case 10:return t.$toast(t.$t("质押成功")),e.next=13,t.init();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](0),t.$toast(e.t0.message);case 18:return e.prev=18,t.$loading.hide(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,15,18,21]])})))()},withDrawGoApprove:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$loading.show(),e.prev=1,n=t.$api.getConnect(),a="mgp"===t.coin?n.addressInfo.orderStakeMGP:n.addressInfo.orderStakeMAST,e.next=7,n.erc20().approve(a,a);case 7:return i=e.sent,t.$refs.notify.show(i.getHash()),e.next=11,i.confirm();case 11:return t.$toast(t.$t("授权成功")),e.next=14,t.init();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](1),t.$toast(e.t0.message);case 19:return e.prev=19,t.$loading.hide(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})))()},goApprove:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$loading.show(),e.prev=1,n=t.$api.getConnect(),a="mgp"===t.coin?n.addressInfo.orderStakeMGP:n.addressInfo.orderStakeMAST,i="mgp"===t.coin?n.addressInfo.mgp:n.addressInfo.mast,e.next=7,n.erc20().approve(a,i);case 7:return s=e.sent,t.$refs.notify.show(s.getHash()),e.next=11,s.confirm();case 11:return t.$toast(t.$t("授权成功")),e.next=14,t.init();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](1),t.$toast(e.t0.message);case 19:return e.prev=19,t.$loading.hide(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})))()},init:function(){var t=arguments,e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,i,s,r,o,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=!(t.length>0&&void 0!==t[0])||t[0],!e.$store.state.walletConnect){n.next=30;break}return n.prev=2,a&&e.$loading.show(),i=e.$api.getConnect(),s="mgp"===e.coin?i.addressInfo.orderStakeMGP:i.addressInfo.orderStakeMAST,r="mgp"===e.coin?i.addressInfo.mgp:i.addressInfo.mast,n.next=9,e.$api.getConnect().erc20().getBalanceAndApprove(s,r,e.$store.state.walletAddress);case 9:return o=n.sent,e.balance=o.amount,e.approve=o.showApprove,n.next=14,i.stake(e.coin).getPoolInfoData(e.$store.state.walletAddress);case 14:c=n.sent,e.xTokenName=c.xToken.symbol,e.now=c.currentBlockTimestamp,e.unlockTimeWindow=c.unlockTimeWindow,e.withdrawAmount=g.a.min(c.userInfo.amount,c.xToken.balance).toFixed(),a&&(e.currentPage=1),e.total=c.userInfo.deposits.length,e.lockOrder=Array.from(c.userInfo.deposits).sort((function(t,n){var a=e.status(t),i=e.status(n);return a-i})),e.showPage();case 25:return n.prev=25,a&&e.$loading.hide(),n.finish(25);case 28:n.next=32;break;case 30:e.balance="0",e.approve=!1;case 32:case"end":return n.stop()}}),n,null,[[2,,25,28]])})))()},sync:function(){var t=this;this.startTime=(new Date).getTime(),this.timeId&&clearTimeout(this.timeId),this.timeId=setTimeout(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.init(!1);case 3:case 4:return e.prev=4,t.sync(),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[0,,4,7]])}))),1e4)}},created:function(){this.coin="mgp"===this.$route.query.coin?"mgp":"mast",this.pid=this.$route.query.id,this.type=this.$route.query.type||"stake",this.init(),this.sync()},destroyed:function(){this.timeId&&clearTimeout(this.timeId)}},b=w,k=n("2877"),_=Object(k["a"])(b,a,i,!1,null,"2def67ac",null);e["default"]=_.exports},"4e82":function(t,e,n){"use strict";var a=n("23e7"),i=n("1c0b"),s=n("7b0b"),r=n("50c4"),o=n("d039"),c=n("addb"),u=n("a640"),l=n("04d1"),d=n("d998"),f=n("2d00"),m=n("512c"),p=[],h=p.sort,v=o((function(){p.sort(void 0)})),g=o((function(){p.sort(null)})),w=u("sort"),b=!o((function(){if(f)return f<70;if(!(l&&l>3)){if(d)return!0;if(m)return m<603;var t,e,n,a,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)p.push({k:e+a,v:n})}for(p.sort((function(t,e){return e.v-t.v})),a=0;a<p.length;a++)e=p[a].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}})),k=v||!g||!w||!b,_=function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:String(e)>String(n)?1:-1}};a({target:"Array",proto:!0,forced:k},{sort:function(t){void 0!==t&&i(t);var e=s(this);if(b)return void 0===t?h.call(e):h.call(e,t);var n,a,o=[],u=r(e.length);for(a=0;a<u;a++)a in e&&o.push(e[a]);o=c(o,_(t)),n=o.length,a=0;while(a<n)e[a]=o[a++];while(a<u)delete e[a++];return e}})},"512c":function(t,e,n){var a=n("342f"),i=a.match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},"5fed":function(t,e,n){"use strict";n("6e79")},"6e79":function(t,e,n){},"7cf4":function(t,e,n){},addb:function(t,e){var n=Math.floor,a=function(t,e){var r=t.length,o=n(r/2);return r<8?i(t,e):s(a(t.slice(0,o),e),a(t.slice(o),e),e)},i=function(t,e){var n,a,i=t.length,s=1;while(s<i){a=s,n=t[s];while(a&&e(t[a-1],n)>0)t[a]=t[--a];a!==s++&&(t[a]=n)}return t},s=function(t,e,n){var a=t.length,i=e.length,s=0,r=0,o=[];while(s<a||r<i)s<a&&r<i?o.push(n(t[s],e[r])<=0?t[s++]:e[r++]):o.push(s<a?t[s++]:e[r++]);return o};t.exports=a},d998:function(t,e,n){var a=n("342f");t.exports=/MSIE|Trident/.test(a)},dc09:function(t,e,n){},ee7a:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-notify",{staticStyle:{opacity:"0.8"},attrs:{type:"success",background:"#2464f6"},model:{value:t.notify.show,callback:function(e){t.$set(t.notify,"show",e)},expression:"notify.show"}},[n("div",{staticClass:"flex align-center justify-between notify"},[n("a",{staticClass:"link flex align-center justify-between",attrs:{href:t.etherscan,target:"_blank"}},[n("div",{staticClass:"flex align-center left bbo"},[n("van-icon",{staticClass:"right",attrs:{name:"passed"}}),n("span",{staticClass:"ellipsis"},[t._v(" "+t._s(t.notify.tx))])],1),n("van-icon",{staticClass:"right",attrs:{name:"arrow"}})],1)])])],1)},i=[],s=(n("3cd0"),n("1a44"),n("acc2"),n("ad06")),r=(n("1812"),n("5e5e"),n("7cf4"),n("c31d")),o=n("2b0e"),c=n("2638"),u=n.n(c),l=n("d282"),d=n("ba31"),f=n("6605"),m=n("e41f"),p=Object(l["a"])("notify"),h=p[0],v=p[1];function g(t,e,n,a){var i={color:e.color,background:e.background};return t(m["a"],u()([{attrs:{value:e.value,position:"top",overlay:!1,duration:.2,lockScroll:!1},style:i,class:[v([e.type]),e.className]},Object(d["a"])(a,!0)]),[(null==n.default?void 0:n.default())||e.message])}g.props=Object(r["a"])({},f["b"],{color:String,message:[Number,String],duration:[Number,String],className:null,background:String,getContainer:[String,Function],type:{type:String,default:"danger"}});var w,b,k=h(g),_=n("a142");function x(t){return Object(_["e"])(t)?t:{message:t}}function $(t){if(!_["f"])return b||(b=Object(d["b"])(k,{on:{click:function(t){b.onClick&&b.onClick(t)},close:function(){b.onClose&&b.onClose()},opened:function(){b.onOpened&&b.onOpened()}}})),t=Object(r["a"])({},$.currentOptions,x(t)),Object(r["a"])(b,t),clearTimeout(w),t.duration&&t.duration>0&&(w=setTimeout($.clear,t.duration)),b}function y(){return{type:"danger",value:!0,message:"",color:void 0,background:void 0,duration:3e3,className:"",onClose:null,onClick:null,onOpened:null}}$.clear=function(){b&&(b.value=!1)},$.currentOptions=y(),$.setDefaultOptions=function(t){Object(r["a"])($.currentOptions,t)},$.resetDefaultOptions=function(){$.currentOptions=y()},$.install=function(){o["a"].use(k)},$.Component=k,o["a"].prototype.$notify=$;var C=$,O=n("365c"),T={name:"notify",components:{"van-notify":C.Component,"van-icon":s["a"]},computed:{etherscan:function(){return O["a"].goEtherscanTx(this.notify.tx)}},data:function(){return{notify:{show:!1,tx:""}}},methods:{show:function(t){var e=this;this.notify.tx=t,this.notify.show=!0,setTimeout((function(){e.notify.show=!1}),5e3)}}},A=T,N=(n("5fed"),n("2877")),S=Object(N["a"])(A,a,i,!1,null,"7ca36873",null);e["a"]=S.exports}}]);